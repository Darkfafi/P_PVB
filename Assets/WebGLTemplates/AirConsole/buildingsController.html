<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" type="text/css" href="css/controller.css">
        <link rel="stylesheet" type="text/css" href="slick/slick.css"/>
        <script type="text/javascript" src="https://www.airconsole.com/api/airconsole-1.7.0.js"></script>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
                
        <script type="text/javascript">
            
            var airConsole = new AirConsole({ "orientation":"landscape" });
            var isReady = true;
            var selectedCardName = "";
            var cardsArray = [];
            
            //Initializer
            function init()
            {
                airConsole.onActivePlayersChange = function() {}
                airConsole.onReady = function() {}
                
                document.getElementById('buildBtn')
                $('#isReady').hide();
                
                receiveMessage();
            }
            
//-----------------------------------------------------------------------------------//
            
            //AirConsole-to-Unity Communicators            
            function drawCardsRequest(cardAmount)
            {
                var drawCardMessage = {
                    'drawCardsRequest':{'cardAmount':cardAmount}
                };
                
                airConsole.message(AirConsole.SCREEN, drawCardMessage);
                console.log("I took some cards");
            }
            
            function takeGoldRequest(goldAmount)
            {
                var takeGoldMessage = {
                    'coinRequest':{'coinAmount':goldAmount}
                };
                
                airConsole.message(AirConsole.SCREEN, takeGoldMessage);
                console.log("gimme money");
            }
            
            function playCardRequest()
            {
                if(selectedCardName === ""){return;}
                
                var playCardMessage = {
                    'playCardRequest':{'cardName':selectedCardName}
                };
                
                airConsole.message(AirConsole.SCREEN, playCardMessage);
                console.log("I built " + selectedCardName);
            }
            
//-----------------------------------------------------------------------------------//
            
            function receiveMessage()
            {
                console.log(airConsole);
                airConsole.onMessage = function(from, data) {
                    
                    if(from === AirConsole.SCREEN && data.action === "gamePhaseUpdate")
                    {
                        switch(data.gamePhase)
                        {
                            case "Lobby":
                                document.getElementById("Lobby").style.visibility = "visible";
                                document.getElementById("Factions").style.visibility = "hidden";
                                document.getElementById("Skills").style.visibility = "hidden";
                                document.getElementById("Turns").style.visibility = "hidden";
                            break;
                                
                            case "Factions":
                                document.getElementById("Lobby").style.visibility = "hidden";
                                document.getElementById("Factions").style.visibility = "visible";
                                document.getElementById("Skills").style.visibility = "hidden";
                                document.getElementById("Turns").style.visibility = "hidden";
                            break;
                                
                            case "Skills":
                                document.getElementById("Lobby").style.visibility = "hidden";
                                document.getElementById("Factions").style.visibility = "hidden";
                                document.getElementById("Skills").style.visibility = "visible";
                                document.getElementById("Turns").style.visibility = "hidden";
                            break;
                                
                            case "Turns":
                                document.getElementById("Lobby").style.visibility = "hidden";
                                document.getElementById("Factions").style.visibility = "hidden";
                                document.getElementById("Skills").style.visibility = "hidden";
                                document.getElementById("Turns").style.visibility = "visible";
                            break;
                        }
                    }
                    
                    if(from === AirConsole.SCREEN && data.action === "UpdateCardsDisplay")
                    {
                        var cardNamesArray = data.info.cardNames.split(",");
                        var cardLocationsArray = data.info.cardLocations.split(",");

                        //"Destroy" the Card's Element.
                        for(var i = 0; i < cardsArray.length; i++)
                        {
                            document.getElementById('card-holder').removeChild(cardsArray[i]);
                        }
                        cardsArray.splice(0, cardsArray.length);

                        //Create a card giving with it the name and card image path.
                        for(var i = 0; i < cardNamesArray.length; i++)
                        {
                            createCard(cardNamesArray[i], cardLocationsArray[i]);
                        }
                    }
                }
            }
            
//-----------------------------------------------------------------------------------//
            
            //Ready Functions
            function readyAction(readyParam)
            {
                var readyMessage = {
                    'readyAction':{'readyState':readyParam}
                };
                
                //Send Message to Unity
                airConsole.message(AirConsole.SCREEN, readyMessage);
                
                $('#isNotReady').hide();
                $('#isReady').show();
            }
            
            function unreadyAction(readyParam)
            {
                var readyMessage = {
                    'readyAction':{'readyState':readyParam}
                };
                
                //Send Message to Unity
                airConsole.message(AirConsole.SCREEN, readyMessage);
                
                $('#isNotReady').show();
                $('#isReady').hide();
            }
            
            //Create Card Function
            function createCard(cardName, cardPath)
            {
                var card = document.createElement("img");
                card.className = "card";
                
                card.src = cardPath;
                
                document.getElementById("card-holder").appendChild(card);
                card.onclick = function(){
                    selectCard(card, cardName);
                };
                cardsArray.push(card);
            }
            
            function selectCard(card, cardName)
            {
                
                selectedCardName = cardName;
            }
            
        </script>
    </head>
    
    <body onload="init()">
        <script type="text/javascript" src="//code.jquery.com/jquery-1.11.0.min.js"></script>
        <script type="text/javascript" src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
        <script type="text/javascript" src="slick/slick.min.js"></script>
        
        <div class="container">
        
            <div id="Turns" class="player-hand-body">

                <!-- Player Info -->
                <div id="player-info">
                    <button id="skill-btn">Skill</button>
                    <br/>
                    <br/>
                    <h1>Skill Name</h1>
                    <ul>
                        <li><h3>Skill Feature</h3></li>
                        <li><h3>Skill Feature</h3></li>
                    </ul>
                </div>

                <!-- Slick Slider -->
                <script type="text/javascript">
                    $(document).ready(function(){
                        $('#cardholder').slick({
                            centerMode: true,
                            centerPadding: '50px',
                            slidesToShow: 3,
                            responsive: [
                                {
                                    breakpoint: 768,
                                    settings: {
                                        arrows: false,
                                        centerMode: true,
                                        centerPadding: '30px',
                                        slidesToShow: 3
                                    }
                                },
                                {
                                    breakpoint: 480,
                                    settings: {
                                        arrows: false,
                                        centerMode: true,
                                        centerPadding: '30px',
                                        slidesToShow: 1
                                    }
                                }
                            ]
                        });
                    });
                </script>

                <div id="player-cards">
                    <h1 style="font-size:2.5em;">Buildable Cards</h1>
                    <div id="card-holder">
<!--
                        <img class="card" src="images/cards/card_chrysler.png">
                        <img class="card" src="images/cards/card_cinnamon.png">
                        <img class="card" src="images/cards/card_destiny.png">
                        <img class="card" src="images/cards/card_lotus.png">
-->
                    </div>
                </div>

                <!-- Player Option Buttons -->
                <div id="player-options">
                    <div id="optionButtons">
                        <button onclick="drawCardsRequest(2)" class="actionButton" id="cardsBtn"><img id="buttonImg" src="images/buttons/icon_cards.png">Cards</button>
                        <h4 id="or">or</h4>
                        <button onclick="takeGoldRequest(2)" class="actionButton" id="coinBtn"><img id="buttonImg" src="images/buttons/icon_gold.png">Gold</button>
                        <h4 id="or">or</h4>
                        <button onclick="playCardRequest()" class="actionButton" id="buildBtn"><img id="buttonImg" src="images/buttons/icon_build.png">Build</button>
                    </div>
                </div>

                <!-- Timer -->
                <div id="timer">
                    <h3>Time Left:</h3>
                    <h1 style="color:white; padding:0; position: relative; bottom: 50%;">28</h1>
                </div>

            </div>

            <div id="Skills" class="skill-select-holder">
                <h1 style="font-size: 3em; text-align: center;">Choose your Skill!</h1>

                <div id="card-holder">
                    <img id="skill_card" class="card" src="images/cards/skills/card_skill_crown.png">
                    <img id="skill_card" class="card" src="images/cards/skills/card_skill_miracle.png">
                    <img id="skill_card" class="card" src="images/cards/skills/card_skill_trade.png">
                    <img id="skill_card" class="card" src="images/cards/skills/card_skill_destruction.png">
                    <img id="skill_card" class="card" src="images/cards/skills/card_skill_stealing.png">
                </div>
            </div>
            
            <div id="Factions" class="faction-select-holder">
                <h1 style="font-size: 3em; text-align: center;">Choose your Faction!</h1>

                <div id="card-holder">
                    
                    <button id="arrow" class="actionButton"></button>
                    
                    <div id="faction-holder">
                        <img id="faction_card" class="card" src="images/factions/character_knight.png">
                    </div>

                    <button id="arrow" class="actionButton"></button>
                    <button class="actionButton"></button>

                </div>
            </div>

            <div id="Lobby" class="ready-screen-holder">
                <h1 style="font-size: 3.5em;">Ready up!</h1>
                <br>
                <button onclick="readyAction(true)" class="actionButton" id="isNotReady"></button>
                <button onclick="unreadyAction(false)" class="actionButton" id="isReady"></button>
            </div>
            
        </div>
        
    </body>
</html>